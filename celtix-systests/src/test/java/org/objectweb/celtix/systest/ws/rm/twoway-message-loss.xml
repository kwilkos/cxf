<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans SYSTEM 
     "http://celtix.objectweb.org/configuration/spring/celtix-spring-beans.dtd">

<beans 
    xmlns:ct="http://celtix.objectweb.org/configuration/types"
    xmlns:sec="http://celtix.objectweb.org/bus/configuration/security"
    xmlns:wsrm-conf="http://celtix.objectweb.org/bus/configuration/wsrm"
    xmlns:wsrm-policy="http://schemas.xmlsoap.org/ws/2005/02/rm/policy"
    xmlns:http-conf="http://celtix.objectweb.org/transports/http/configuration"
    xmlns:jaxws-types="http://celtix.objectweb.org/bus/jaxws/configuration/types">
    
    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService/GreeterPort.http-client" 
        class="org.objectweb.celtix.bus.transports.http.http_client_config.spring.HttpClientConfigBean">    
        <property name="httpClient">
            <value>
                <http-conf:client DecoupledEndpoint="http://localhost:9999/decoupled_endpoint"/>
            </value>
        </property>
    </bean>

    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService"
        class="org.objectweb.celtix.bus.jaxws.endpoint_config.spring.EndpointConfigBean">
        <property name="handlerChain">
            <value>
                <jaxws-types:handler-chain>
                    <jaxws-types:handler>
                        <jaxws-types:handler-name>MessageLossSimulator</jaxws-types:handler-name>
                        <jaxws-types:handler-class>org.objectweb.celtix.systest.ws.rm.MessageLossSimulator</jaxws-types:handler-class>
                    </jaxws-types:handler>
                </jaxws-types:handler-chain>              
            </value>
        </property>
    </bean>
    
    <bean id="rm-handler-all" abstract="true"/>
    
    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService.rm-handler" 
        class="org.objectweb.celtix.bus.ws.rm.rm_config.spring.RmConfigBean"
        parent="rm-handler-all"> 
        <!-- avoid server side resends -->
        <property name="rmAssertion">
            <value>
                <wsrm-policy:RMAssertion>         
                    <wsrm-policy:BaseRetransmissionInterval Milliseconds="30000"/>           
                    <wsrm-policy:AcknowledgementInterval Milliseconds="2000"/>                                                        
                </wsrm-policy:RMAssertion>
            </value>
        </property> 
                   
    </bean>
    
    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService/GreeterPort.rm-handler" 
        class="org.objectweb.celtix.bus.ws.rm.rm_config.spring.RmConfigBean"
        parent="rm-handler-all">           
    </bean>
    
    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService.wsa-handler" 
        class="org.objectweb.celtix.bus.ws.addressing.wsa_config.spring.WsaConfigBean"> 
        <property name="allowDuplicates" value="true"/>           
    </bean>
    
    <bean id="celtix.{http://celtix.objectweb.org/greeter_control}GreeterService/GreeterPort.wsa-handler" 
        class="org.objectweb.celtix.bus.ws.addressing.wsa_config.spring.WsaConfigBean"> 
        <property name="allowDuplicates" value="true"/>              
    </bean>

</beans>
